CREATE EXTENSION fhir_jsonb;
CREATE EXTENSION jsquery;
set escape_string_warning=off;
select count(*)
from patients;
 count 
-------
   100
(1 row)

SELECT DISTINCT ON (doc #>> '{active}')
doc #>> '{active}'
FROM patients
ORDER BY doc #>> '{active}';
 ?column? 
----------
 false
 true
(2 rows)

select count(*)
from encounters;
 count 
-------
  1000
(1 row)

select count(*)
from observations;
 count 
-------
 10000
(1 row)

SELECT DISTINCT ON (doc #>> '{name}')
doc #>> '{name,coding,0,display}'
FROM observations
ORDER BY doc #>> '{name}';
              ?column?               
-------------------------------------
 Blood pressure systolic & diastolic
 Body temperature
 noise
(3 rows)

SELECT DISTINCT ON (doc #>> '{status}')
doc #>> '{status}'
FROM observations
ORDER BY doc #>> '{status}';
     ?column?     
------------------
 amended
 cancelled
 entered in error
 final
 preliminary
 registered
(6 rows)

